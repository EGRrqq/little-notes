var F=Object.defineProperty;var X=(o,e,s)=>e in o?F(o,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):o[e]=s;var R=(o,e,s)=>(X(o,typeof e!="symbol"?e+"":e,s),s),A=(o,e,s)=>{if(!e.has(o))throw TypeError("Cannot "+s)};var t=(o,e,s)=>(A(o,e,"read from private field"),s?s.call(o):e.get(o)),n=(o,e,s)=>{if(e.has(o))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(o):e.set(o,s)},a=(o,e,s,f)=>(A(o,e,"write to private field"),f?f.call(o,s):e.set(o,s),s);var S=(o,e,s)=>(A(o,e,"access private method"),s);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))f(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const V of i.addedNodes)V.tagName==="LINK"&&V.rel==="modulepreload"&&f(V)}).observe(document,{childList:!0,subtree:!0});function s(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerPolicy&&(i.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?i.credentials="include":r.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function f(r){if(r.ep)return;r.ep=!0;const i=s(r);fetch(r.href,i)}})();var m,g;class Y{constructor(e){n(this,m,void 0);n(this,g,null);R(this,"setCanvasFullSize",()=>{this.canvas.width=window.innerWidth,this.canvas.height=window.innerHeight});a(this,m,e)}get canvas(){return t(this,m)}get ctx(){return this.canvas.getContext("2d")}set selectTool(e){a(this,g,e)}get selectedTool(){return t(this,g)}}m=new WeakMap,g=new WeakMap;var w,L,C;class N{constructor(){n(this,w,0);n(this,L,0);n(this,C,!1)}get pressed(){return t(this,C)}set pressed(e){a(this,C,e)}getPrevValues(){return[t(this,w),t(this,L)]}setPrevValues(e,s){a(this,w,e),a(this,L,s)}}w=new WeakMap,L=new WeakMap,C=new WeakMap;const c=new N;var h,b,T,y;class W{constructor(e){n(this,h,void 0);n(this,b,e=>{c.pressed=!0,c.setPrevValues(e.clientX,e.clientY)});n(this,T,e=>{var s;c.pressed&&((s=t(this,h).selectedTool)==null||s.draw(e.clientX,e.clientY))});n(this,y,()=>{c.pressed=!1});a(this,h,e)}attach(){t(this,h).canvas.addEventListener("mousedown",t(this,b)),t(this,h).canvas.addEventListener("mousemove",t(this,T)),t(this,h).canvas.addEventListener("mouseup",t(this,y))}}h=new WeakMap,b=new WeakMap,T=new WeakMap,y=new WeakMap;var d,x,M,O;class j{constructor(e){n(this,d,void 0);n(this,x,e=>{c.pressed=!0,c.setPrevValues(e.touches[0].pageX,e.touches[0].pageY)});n(this,M,e=>{var s;e.preventDefault(),c.pressed&&((s=t(this,d).selectedTool)==null||s.draw(e.touches[0].pageX,e.touches[0].pageY))});n(this,O,()=>{c.pressed=!1});a(this,d,e)}attach(){t(this,d).canvas.addEventListener("touchstart",t(this,x)),t(this,d).canvas.addEventListener("touchmove",t(this,M)),t(this,d).canvas.addEventListener("touchend",t(this,O))}}d=new WeakMap,x=new WeakMap,M=new WeakMap,O=new WeakMap;var l;class q{constructor(e){n(this,l,void 0);a(this,l,e)}draw(e,s){t(this,l).ctx&&(t(this,l).ctx.moveTo(...c.getPrevValues()),t(this,l).ctx.lineTo(e,s),t(this,l).ctx.closePath(),t(this,l).ctx.stroke(),c.setPrevValues(e,s))}}l=new WeakMap;var E,p,u,z,B,I,U,P;class H{constructor(e){n(this,z);n(this,E,"");n(this,p,new Image);n(this,u,void 0);n(this,I,()=>{t(this,p).src=t(this,E)});n(this,U,()=>{var e;(e=t(this,u).ctx)==null||e.drawImage(t(this,p),0,0)});n(this,P,()=>{S(this,z,B).call(this,t(this,u).canvas)});a(this,u,e),t(this,p).addEventListener("load",t(this,U)),window.addEventListener("resize",t(this,I))}mouseAttach(){t(this,u).canvas.addEventListener("mouseup",t(this,P))}touchAttach(){t(this,u).canvas.addEventListener("touchend",t(this,P))}}E=new WeakMap,p=new WeakMap,u=new WeakMap,z=new WeakSet,B=function(e){e.toBlob(s=>{s&&a(this,E,URL.createObjectURL(s))})},I=new WeakMap,U=new WeakMap,P=new WeakMap;const K=document.getElementById("board"),v=new Y(K),G=new W(v),J=new j(v);G.attach();J.attach();const D=new H(v);D.mouseAttach();D.touchAttach();const Q=new q(v);v.selectTool=Q;window.addEventListener("load",v.setCanvasFullSize,{once:!0});window.addEventListener("resize",v.setCanvasFullSize);
