var Et=Object.defineProperty;var Dt=(n,t,s)=>t in n?Et(n,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):n[t]=s;var E=(n,t,s)=>(Dt(n,typeof t!="symbol"?t+"":t,s),s),ut=(n,t,s)=>{if(!t.has(n))throw TypeError("Cannot "+s)};var e=(n,t,s)=>(ut(n,t,"read from private field"),s?s.call(n):t.get(n)),o=(n,t,s)=>{if(t.has(n))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(n):t.set(n,s)},r=(n,t,s,a)=>(ut(n,t,"write to private field"),a?a.call(n,s):t.set(n,s),s);var dt=(n,t,s)=>(ut(n,t,"access private method"),s);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))a(i);new MutationObserver(i=>{for(const l of i)if(l.type==="childList")for(const v of l.addedNodes)v.tagName==="LINK"&&v.rel==="modulepreload"&&a(v)}).observe(document,{childList:!0,subtree:!0});function s(i){const l={};return i.integrity&&(l.integrity=i.integrity),i.referrerPolicy&&(l.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?l.credentials="include":i.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function a(i){if(i.ep)return;i.ep=!0;const l=s(i);fetch(i.href,l)}})();var M,I;class Lt{constructor(t){o(this,M,void 0);o(this,I,void 0);E(this,"setCanvasFullSize",()=>{this.canvas.width=window.innerWidth,this.canvas.height=window.innerHeight});E(this,"clearCanvasData",()=>{var t;(t=this.ctx)==null||t.clearRect(0,0,this.canvas.width,this.canvas.height)});E(this,"moveOriginPointTo",(t,s)=>{var a;(a=this.ctx)==null||a.translate(t,s)});E(this,"resetOriginPoint",()=>{var t;(t=this.ctx)==null||t.setTransform(1,0,0,1,0,0)});r(this,M,t),r(this,I,this.canvas.getContext("2d"))}get canvas(){return e(this,M)}get ctx(){return e(this,I)}}M=new WeakMap,I=new WeakMap;var Y,X,_;class Pt{constructor(){o(this,Y,0);o(this,X,0);o(this,_,!1)}get pressed(){return e(this,_)}set pressed(t){r(this,_,t)}getPrevValues(){return[e(this,Y),e(this,X)]}setPrevValues(t,s){r(this,Y,t),r(this,X,s)}}Y=new WeakMap,X=new WeakMap,_=new WeakMap;const u=new Pt;var w,k,Z,tt,et;class Ot{constructor(t,s){o(this,w,void 0);o(this,k,void 0);o(this,Z,t=>{u.pressed=!0,u.setPrevValues(t.clientX,t.clientY)});o(this,tt,t=>{u.pressed&&(e(this,k).activeTool.draw(...u.getPrevValues(),t.clientX,t.clientY),u.setPrevValues(t.clientX,t.clientY))});o(this,et,()=>{u.pressed=!1});r(this,w,t),r(this,k,s)}attach(){e(this,w).addEventListener("mousedown",e(this,Z)),e(this,w).addEventListener("mousemove",e(this,tt)),e(this,w).addEventListener("mouseup",e(this,et))}}w=new WeakMap,k=new WeakMap,Z=new WeakMap,tt=new WeakMap,et=new WeakMap;var y,F,st,nt,ot;class St{constructor(t,s){o(this,y,void 0);o(this,F,void 0);o(this,st,t=>{u.pressed=!0,u.setPrevValues(t.touches[0].clientX,t.touches[0].clientY)});o(this,nt,t=>{t.preventDefault(),u.pressed&&(e(this,F).activeTool.draw(...u.getPrevValues(),Math.round(t.touches[0].clientX),Math.round(t.touches[0].clientY)),u.setPrevValues(t.touches[0].clientX,t.touches[0].clientY))});o(this,ot,()=>{u.pressed=!0});r(this,y,t),r(this,F,s)}attach(){e(this,y).addEventListener("touchstart",e(this,st)),e(this,y).addEventListener("touchmove",e(this,nt)),e(this,y).addEventListener("touchend",e(this,ot))}}y=new WeakMap,F=new WeakMap,st=new WeakMap,nt=new WeakMap,ot=new WeakMap;var N,rt,g,L;class xt{constructor(t){o(this,g);o(this,N,void 0);o(this,rt,"pen");r(this,N,t)}get type(){return e(this,rt)}draw(t,s,a,i){e(this,g,L).beginPath(),e(this,g,L).moveTo(t,s),e(this,g,L).lineTo(a,i),e(this,g,L).closePath(),e(this,g,L).stroke()}settings(){}}N=new WeakMap,rt=new WeakMap,g=new WeakSet,L=function(){return e(this,N)};var C,P;class bt{constructor(t,s="pen"){o(this,C,void 0);o(this,P,void 0);r(this,C,{});for(let a of t)e(this,C)[a.type]=a;r(this,P,e(this,C)[s])}get tools(){return e(this,C)}get activeTool(){return e(this,P)}set activeTool(t){r(this,P,t)}}C=new WeakMap,P=new WeakMap;var U,V,A,R,$,j,it,vt;class mt{constructor(){o(this,it);o(this,U,"");o(this,V,[]);o(this,A,"");o(this,R,0);o(this,$,0);o(this,j,[0,0]);dt(this,it,vt).call(this,3)}get id(){return e(this,U)}get type(){return e(this,A)}set type(t){r(this,A,t)}get x(){return e(this,R)}set x(t){r(this,R,t)}get y(){return e(this,$)}set y(t){r(this,$,t)}get points(){return e(this,V)}set point(t){e(this,V).push(t)}get lastPoint(){return e(this,j)}set lastPoint(t){r(this,j,t)}get elementData(){return{id:this.id,points:this.points,type:this.type,x:this.x,y:this.y,lastPoint:this.lastPoint}}}U=new WeakMap,V=new WeakMap,A=new WeakMap,R=new WeakMap,$=new WeakMap,j=new WeakMap,it=new WeakSet,vt=function(t=1){let s=0;for(;s<t;)r(this,U,e(this,U)+Math.random().toString(36).substring(2)),s++};var O;class Bt{constructor(){o(this,O,[])}get elements(){return e(this,O)}set elements(t){r(this,O,t)}pushElement(t){e(this,O).push(t)}get allData(){return{elements:this.elements}}}O=new WeakMap;var S,x,J,z,b,at,ft,K,pt,B,Q,c,h,wt,q,H,W;class Tt{constructor(t){o(this,at);o(this,K);o(this,B);o(this,c);o(this,S,!1);o(this,x,new Bt);o(this,J,"LittleNotes");o(this,z,new mt);o(this,b,void 0);E(this,"iterateOverPoints",t=>{for(let s=0,a=t.length-1;s<a;s++){let i=t[s][0],l=t[s][1],v=t[s+1][0],ht=t[s+1][1];e(this,b).activeTool.draw(i,l,v,ht)}});o(this,q,(t,s)=>{r(this,S,!0),r(this,c,new mt,wt),e(this,c,h).type=e(this,b).activeTool.type,e(this,c,h).x=t,e(this,c,h).y=s,e(this,c,h).point=[0,0],e(this,c,h).lastPoint=[0,0]});o(this,H,(t,s)=>{e(this,S)&&(e(this,c,h).point=[t-e(this,c,h).x,s-e(this,c,h).y],e(this,c,h).lastPoint=[t-e(this,c,h).x,s-e(this,c,h).y])});o(this,W,()=>{r(this,S,!1),this.storeDataElement(e(this,c,h).elementData)});r(this,b,t),dt(this,at,ft).call(this)}mouseAttach(t){t.addEventListener("mousedown",s=>e(this,q).call(this,s.clientX,s.clientY)),t.addEventListener("mousemove",s=>e(this,H).call(this,s.clientX,s.clientY)),t.addEventListener("mouseup",()=>e(this,W).call(this))}touchAttach(t){t.addEventListener("touchstart",s=>e(this,q).call(this,Math.round(s.touches[0].clientX),Math.round(s.touches[0].clientY))),t.addEventListener("touchmove",s=>e(this,H).call(this,Math.round(s.touches[0].clientX),Math.round(s.touches[0].clientY))),t.addEventListener("touchend",()=>e(this,W).call(this))}get appData(){return e(this,x).allData}storeDataElement(t){e(this,B,Q).pushElement(t),localStorage.setItem(e(this,K,pt),JSON.stringify(e(this,B,Q).elements))}clearDataElements(){e(this,B,Q).elements=[],localStorage.removeItem(e(this,K,pt))}}S=new WeakMap,x=new WeakMap,J=new WeakMap,z=new WeakMap,b=new WeakMap,at=new WeakSet,ft=function(){const t=localStorage.getItem(e(this,J));t&&(e(this,x).elements=JSON.parse(t))},K=new WeakSet,pt=function(){return e(this,J)},B=new WeakSet,Q=function(){return e(this,x)},c=new WeakSet,h=function(){return e(this,z)},wt=function(t){r(this,z,t)},q=new WeakMap,H=new WeakMap,W=new WeakMap;var G,lt,yt;class ct{constructor(t){o(this,lt);o(this,G,void 0);r(this,G,t)}onClick(t){e(this,lt,yt).addEventListener("click",()=>t())}}G=new WeakMap,lt=new WeakSet,yt=function(){return e(this,G)};var p,d;class Mt{constructor(t){o(this,p,void 0);o(this,d,void 0);r(this,p,t),r(this,d,"false"),e(this,p).dataset.isOpen=e(this,d)}toggleIsOpen(){switch(e(this,d)){case"true":r(this,d,"false"),e(this,p).dataset.isOpen=e(this,d);break;case"false":r(this,d,"true"),e(this,p).dataset.isOpen=e(this,d);break}}toggleClass(t){switch(e(this,d)){case"true":e(this,p).classList.remove(t);break;case"false":e(this,p).classList.add(t);break}}}p=new WeakMap,d=new WeakMap;const It=document.getElementById("menu__toggle-btn"),Yt=document.getElementById("menu-dropdown__open"),Xt=document.getElementById("menu-dropdown__save"),_t=document.getElementById("menu-dropdown__clear"),kt=document.getElementById("menu-dropdown"),Ft=new ct(It),gt=new Mt(kt),Nt=new ct(Yt),Ut=new ct(Xt),Vt=new ct(_t),At=(n,t,s)=>{const a=new Blob([JSON.stringify(n,null,2)],{type:s}),i=URL.createObjectURL(a),l=document.createElement("a");l.href=i,l.download=t,l.click(),URL.revokeObjectURL(i),l.remove()},Rt=(n,t)=>{const s=document.createElement("input");s.type="file",s.accept=t,s.addEventListener("change",a=>$t(a,n),{once:!0}),s.click(),s.remove()};function $t(n,t){var a;const s=(a=n.target.files)==null?void 0:a[0];if(s){const i=new FileReader;i.addEventListener("load",l=>jt(l,t),{once:!0}),i.readAsText(s)}}function jt(n,t){const s=JSON.parse(n.target.result);t(s)}function Jt(n){const t=n.getFullYear(),s=(n.getMonth()+1).toString().padStart(2,"0"),a=n.getDate().toString().padStart(2,"0"),i=n.getHours().toString().padStart(2,"0"),l=n.getMinutes().toString().padStart(2,"0");return`${t}-${s}-${a}_${i}-${l}`}const T=document.getElementById("board"),D=new Lt(T),zt="menu-dropdown--isClosed";if(D.ctx){let n=function(){for(let f of m.appData.elements)D.moveOriginPointTo(f.x,f.y),m.iterateOverPoints(f.points),D.resetOriginPoint()},t=function(){D.setCanvasFullSize(),D.clearCanvasData(),requestAnimationFrame(n)},s=function(){Ft.onClick(()=>{gt.toggleIsOpen(),gt.toggleClass(zt)}),Ut.onClick(()=>{const f=Jt(new Date);At(m.appData,`untitled_${f}.json`,"application/json")}),Nt.onClick(()=>Rt(f=>{m.clearDataElements();for(let Ct of f.elements)m.storeDataElement(Ct);t()},"application/json")),Vt.onClick(()=>{m.clearDataElements(),t()})};const a=new xt(D.ctx),i=[a],l=new bt(i,a.type),v=new Ot(T,l),ht=new St(T,l);v.attach(),ht.attach();const m=new Tt(l);m.mouseAttach(T),m.touchAttach(T),window.addEventListener("resize",t),window.addEventListener("load",t,{once:!0}),window.addEventListener("load",s,{once:!0})}
