var Pt=Object.defineProperty;var Dt=(n,t,s)=>t in n?Pt(n,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):n[t]=s;var E=(n,t,s)=>(Dt(n,typeof t!="symbol"?t+"":t,s),s),dt=(n,t,s)=>{if(!t.has(n))throw TypeError("Cannot "+s)};var e=(n,t,s)=>(dt(n,t,"read from private field"),s?s.call(n):t.get(n)),o=(n,t,s)=>{if(t.has(n))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(n):t.set(n,s)},a=(n,t,s,i)=>(dt(n,t,"write to private field"),i?i.call(n,s):t.set(n,s),s);var pt=(n,t,s)=>(dt(n,t,"access private method"),s);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const l of r)if(l.type==="childList")for(const v of l.addedNodes)v.tagName==="LINK"&&v.rel==="modulepreload"&&i(v)}).observe(document,{childList:!0,subtree:!0});function s(r){const l={};return r.integrity&&(l.integrity=r.integrity),r.referrerPolicy&&(l.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?l.credentials="include":r.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function i(r){if(r.ep)return;r.ep=!0;const l=s(r);fetch(r.href,l)}})();var M,I;class Lt{constructor(t){o(this,M,void 0);o(this,I,void 0);E(this,"setCanvasFullSize",(t,s,i)=>{var r;this.canvas.width=t*i,this.canvas.height=s*i,(r=this.ctx)==null||r.scale(i,i),this.canvas.style.width=`${window.innerWidth}px`,this.canvas.style.height=`${window.innerHeight}px`});E(this,"clearCanvasData",()=>{var t;(t=this.ctx)==null||t.clearRect(0,0,this.canvas.width,this.canvas.height)});E(this,"moveOriginPointTo",(t,s)=>{var i;(i=this.ctx)==null||i.translate(t,s)});E(this,"resetOriginPoint",t=>{var s;(s=this.ctx)==null||s.setTransform(t,0,0,t,0,0)});a(this,M,t),a(this,I,this.canvas.getContext("2d"))}get canvas(){return e(this,M)}get ctx(){return e(this,I)}}M=new WeakMap,I=new WeakMap;var Y,X,_;class Ot{constructor(){o(this,Y,0);o(this,X,0);o(this,_,!1)}get pressed(){return e(this,_)}set pressed(t){a(this,_,t)}getPrevValues(){return[e(this,Y),e(this,X)]}setPrevValues(t,s){a(this,Y,t),a(this,X,s)}}Y=new WeakMap,X=new WeakMap,_=new WeakMap;const u=new Ot;var w,k,tt,et,st;class xt{constructor(t,s){o(this,w,void 0);o(this,k,void 0);o(this,tt,t=>{u.pressed=!0,u.setPrevValues(t.clientX,t.clientY)});o(this,et,t=>{u.pressed&&(e(this,k).activeTool.draw(...u.getPrevValues(),t.clientX,t.clientY),u.setPrevValues(t.clientX,t.clientY))});o(this,st,()=>{u.pressed=!1});a(this,w,t),a(this,k,s)}attach(){e(this,w).addEventListener("mousedown",e(this,tt)),e(this,w).addEventListener("mousemove",e(this,et)),e(this,w).addEventListener("mouseup",e(this,st))}}w=new WeakMap,k=new WeakMap,tt=new WeakMap,et=new WeakMap,st=new WeakMap;var y,F,nt,ot,it;class St{constructor(t,s){o(this,y,void 0);o(this,F,void 0);o(this,nt,t=>{u.pressed=!0,u.setPrevValues(t.touches[0].clientX,t.touches[0].clientY)});o(this,ot,t=>{t.preventDefault(),u.pressed&&(e(this,F).activeTool.draw(...u.getPrevValues(),Math.round(t.touches[0].clientX),Math.round(t.touches[0].clientY)),u.setPrevValues(t.touches[0].clientX,t.touches[0].clientY))});o(this,it,()=>{u.pressed=!0});a(this,y,t),a(this,F,s)}attach(){e(this,y).addEventListener("touchstart",e(this,nt)),e(this,y).addEventListener("touchmove",e(this,ot)),e(this,y).addEventListener("touchend",e(this,it))}}y=new WeakMap,F=new WeakMap,nt=new WeakMap,ot=new WeakMap,it=new WeakMap;var N,rt,m,D;class bt{constructor(t){o(this,m);o(this,N,void 0);o(this,rt,"pen");a(this,N,t)}get type(){return e(this,rt)}draw(t,s,i,r){e(this,m,D).beginPath(),e(this,m,D).moveTo(t,s),e(this,m,D).lineTo(i,r),e(this,m,D).closePath(),e(this,m,D).stroke()}settings(){}}N=new WeakMap,rt=new WeakMap,m=new WeakSet,D=function(){return e(this,N)};var C,L;class Bt{constructor(t,s="pen"){o(this,C,void 0);o(this,L,void 0);a(this,C,{});for(let i of t)e(this,C)[i.type]=i;a(this,L,e(this,C)[s])}get tools(){return e(this,C)}get activeTool(){return e(this,L)}set activeTool(t){a(this,L,t)}}C=new WeakMap,L=new WeakMap;var R,U,V,$,A,j,at,ft;class mt{constructor(){o(this,at);o(this,R,"");o(this,U,[]);o(this,V,"");o(this,$,0);o(this,A,0);o(this,j,[0,0]);pt(this,at,ft).call(this,3)}get id(){return e(this,R)}get type(){return e(this,V)}set type(t){a(this,V,t)}get x(){return e(this,$)}set x(t){a(this,$,t)}get y(){return e(this,A)}set y(t){a(this,A,t)}get points(){return e(this,U)}set point(t){e(this,U).push(t)}get lastPoint(){return e(this,j)}set lastPoint(t){a(this,j,t)}get elementData(){return{id:this.id,points:this.points,type:this.type,x:this.x,y:this.y,lastPoint:this.lastPoint}}}R=new WeakMap,U=new WeakMap,V=new WeakMap,$=new WeakMap,A=new WeakMap,j=new WeakMap,at=new WeakSet,ft=function(t=1){let s=0;for(;s<t;)a(this,R,e(this,R)+Math.random().toString(36).substring(2)),s++};var O;class Tt{constructor(){o(this,O,[])}get elements(){return e(this,O)}set elements(t){a(this,O,t)}pushElement(t){e(this,O).push(t)}get allData(){return{elements:this.elements}}}O=new WeakMap;var x,S,H,W,b,lt,wt,J,gt,B,Z,c,h,yt,z,K,q;class Mt{constructor(t){o(this,lt);o(this,J);o(this,B);o(this,c);o(this,x,!1);o(this,S,new Tt);o(this,H,"LittleNotes");o(this,W,new mt);o(this,b,void 0);E(this,"iterateOverPoints",t=>{for(let s=0,i=t.length-1;s<i;s++){let r=t[s][0],l=t[s][1],v=t[s+1][0],ut=t[s+1][1];e(this,b).activeTool.draw(r,l,v,ut)}});o(this,z,(t,s)=>{a(this,x,!0),a(this,c,new mt,yt),e(this,c,h).type=e(this,b).activeTool.type,e(this,c,h).x=t,e(this,c,h).y=s,e(this,c,h).point=[0,0],e(this,c,h).lastPoint=[0,0]});o(this,K,(t,s)=>{e(this,x)&&(e(this,c,h).point=[t-e(this,c,h).x,s-e(this,c,h).y],e(this,c,h).lastPoint=[t-e(this,c,h).x,s-e(this,c,h).y])});o(this,q,()=>{a(this,x,!1),this.storeDataElement(e(this,c,h).elementData)});a(this,b,t),pt(this,lt,wt).call(this)}mouseAttach(t){t.addEventListener("mousedown",s=>e(this,z).call(this,s.clientX,s.clientY)),t.addEventListener("mousemove",s=>e(this,K).call(this,s.clientX,s.clientY)),t.addEventListener("mouseup",()=>e(this,q).call(this))}touchAttach(t){t.addEventListener("touchstart",s=>e(this,z).call(this,Math.round(s.touches[0].clientX),Math.round(s.touches[0].clientY))),t.addEventListener("touchmove",s=>e(this,K).call(this,Math.round(s.touches[0].clientX),Math.round(s.touches[0].clientY))),t.addEventListener("touchend",()=>e(this,q).call(this))}get appData(){return e(this,S).allData}storeDataElement(t){e(this,B,Z).pushElement(t),localStorage.setItem(e(this,J,gt),JSON.stringify(e(this,B,Z).elements))}clearDataElements(){e(this,B,Z).elements=[],localStorage.removeItem(e(this,J,gt))}}x=new WeakMap,S=new WeakMap,H=new WeakMap,W=new WeakMap,b=new WeakMap,lt=new WeakSet,wt=function(){const t=localStorage.getItem(e(this,H));t&&(e(this,S).elements=JSON.parse(t))},J=new WeakSet,gt=function(){return e(this,H)},B=new WeakSet,Z=function(){return e(this,S)},c=new WeakSet,h=function(){return e(this,W)},yt=function(t){a(this,W,t)},z=new WeakMap,K=new WeakMap,q=new WeakMap;var G,ct,Ct;class ht{constructor(t){o(this,ct);o(this,G,void 0);a(this,G,t)}onClick(t){e(this,ct,Ct).addEventListener("click",()=>t())}}G=new WeakMap,ct=new WeakSet,Ct=function(){return e(this,G)};var p,d;class It{constructor(t){o(this,p,void 0);o(this,d,void 0);a(this,p,t),a(this,d,"false"),e(this,p).dataset.isOpen=e(this,d)}toggleIsOpen(){switch(e(this,d)){case"true":a(this,d,"false"),e(this,p).dataset.isOpen=e(this,d);break;case"false":a(this,d,"true"),e(this,p).dataset.isOpen=e(this,d);break}}toggleClass(t){switch(e(this,d)){case"true":e(this,p).classList.remove(t);break;case"false":e(this,p).classList.add(t);break}}}p=new WeakMap,d=new WeakMap;const Yt=document.getElementById("menu__toggle-btn"),Xt=document.getElementById("menu-dropdown__open"),_t=document.getElementById("menu-dropdown__save"),kt=document.getElementById("menu-dropdown__clear"),Ft=document.getElementById("menu-dropdown"),Nt=new ht(Yt),vt=new It(Ft),Rt=new ht(Xt),Ut=new ht(_t),Vt=new ht(kt),$t=(n,t,s)=>{const i=new Blob([JSON.stringify(n,null,2)],{type:s}),r=URL.createObjectURL(i),l=document.createElement("a");l.href=r,l.download=t,l.click(),URL.revokeObjectURL(r),l.remove()},At=(n,t)=>{const s=document.createElement("input");s.type="file",s.accept=t,s.addEventListener("change",i=>jt(i,n),{once:!0}),s.click(),s.remove()};function jt(n,t){var i;const s=(i=n.target.files)==null?void 0:i[0];if(s){const r=new FileReader;r.addEventListener("load",l=>Ht(l,t),{once:!0}),r.readAsText(s)}}function Ht(n,t){const s=JSON.parse(n.target.result);t(s)}function Wt(n){const t=n.getFullYear(),s=(n.getMonth()+1).toString().padStart(2,"0"),i=n.getDate().toString().padStart(2,"0"),r=n.getHours().toString().padStart(2,"0"),l=n.getMinutes().toString().padStart(2,"0");return`${t}-${s}-${i}_${r}-${l}`}class Jt{get dpr(){return window.devicePixelRatio}get innerHeight(){return window.innerHeight}get innerWidth(){return window.innerWidth}}const T=document.getElementById("board"),P=new Lt(T),Q=new Jt,zt="menu-dropdown--isClosed";if(P.ctx){let n=function(){for(let f of g.appData.elements)P.moveOriginPointTo(f.x,f.y),g.iterateOverPoints(f.points),P.resetOriginPoint(Q.dpr)},t=function(){P.setCanvasFullSize(Q.innerWidth,Q.innerHeight,Q.dpr),P.clearCanvasData(),requestAnimationFrame(n)},s=function(){Nt.onClick(()=>{vt.toggleIsOpen(),vt.toggleClass(zt)}),Ut.onClick(()=>{const f=Wt(new Date);$t(g.appData,`untitled_${f}.json`,"application/json")}),Rt.onClick(()=>At(f=>{g.clearDataElements();for(let Et of f.elements)g.storeDataElement(Et);t()},"application/json")),Vt.onClick(()=>{g.clearDataElements(),t()})};const i=new bt(P.ctx),r=[i],l=new Bt(r,i.type),v=new xt(T,l),ut=new St(T,l);v.attach(),ut.attach();const g=new Mt(l);g.mouseAttach(T),g.touchAttach(T),window.addEventListener("resize",t),window.addEventListener("load",t,{once:!0}),window.addEventListener("load",s,{once:!0})}
